/*!

	Surmoi - Resume, CV, vCard, Portfolio Template
	Copyright (c) 2015, Subramanian 

	Author: Subramanian
	Profile: themeforest.net/user/FMedia/
	
	Version: 1.0.0
	Release Date: April 2015
	
*/	


"use strict";
		
/* Define required varaible */
	var isMobile = screen.width <= 767; 
	var mobileDevice = screen.width < 1024 && screen.height < 1024;
	var isSmartPhone = ((screen.width <= 959) || (screen.height <= 959));
	var ipad = (screen.width === 768 || screen.height === 768) && (screen.width === 1024 || screen.height === 1024) ;
	var lowResDesktop = window.innerWidth <= 979;
	var isMobileChk = screen.width < 768;
	var isTouch = false;	
	var isMouseDrag = ($("body").hasClass("not_mouseDrag") ||  $("body").hasClass("not_onepage_ver")) ? false : true;	
	var siteStartOpen = false;
	var scrollPos = 0;
	var flxDelay = 5000;
	var headerClose = false;
	var pageHeaderHeight = 90;
	var pageHeaderHeight_mini = 0;
	var defaultVolume = 0;
	var apiRS;
	var supersizedOnBody = true;	
	var superSliderLoad = false;
	var sSliderInter;
	var pageBorder_z = 60;
	
	var projPage = $(".ajaxPopupPage").length > 0? true : false;
	
	
	var isTouch = false;
	var swipeThreshold = 75;
	var siteStartOpen = false;
	var scrollPos = 0;
	var flxDelay = 5000;
	var fmUrl = undefined;
	var currentPage_menu = "home";
	var leftMenu = true;
	var pageAlignCenter =  false;
	var scrollHorizontal =  false;
	var onePageVersion =  false;
	var browserWebkit;	
	/* set top Menu height - to fix the browser bug */
	var topMenuHeight = 60;
	/* Enable/disable Menuauto Hide */
	var menuAutoHide = true;
	/* preload images are defined here */	
	var preLoadImgs = [];
	
	var cssAnimate = true;
	
	var animateSyntax = "transition";
	
	
	var BigVid;
	var bgVideopath = "videos/video.mp4";
	
	
	var agent;
	var ipadDevice;
	var iPhoneDevice;
	var iVersion;
	var retinaDevice;	

	var fancy_bgCol = "#fff";
	var fancy_bgCol_alpha = 1;
	
	var aniInEff = "animated fast fadeInDown";
	var aniOutEff = "animated fast fadeOutUp";
	

	$(document).ready(function(){
			
		
		/* Site Main plug-in initilize */
		jQuery(function($){
			$("body").mainFm({
				
				/* FlexSlider slideshow speed */
				slideshowSpeed : 5000
				
			});
		});
		
		
		
		//quick Contact Form
			
		$("#email_submit_quickContact").on('click', function() {
								
			$('.quickContact #reply_message').removeClass();
			$('.quickContact #reply_message').html('')
			var regEx = "";	 
							
			// validate Name				
			var name = $(".quickContact input#q_name").val();  
			regEx=/^[A-Za-z .'-]+$/; 
			if (name == "" || name == "Name"  || !regEx.test(name)) { 
				$(".quickContact input#q_name").val(''); 
				$(".quickContact input#q_name").focus();  
				return false;  
			}
			
			// validate Email						  
			var email = $(".quickContact input#q_email").val();  
			regEx=/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;											
			if (email == "" || email == "Email" || !regEx.test(email)) { 
				$(".quickContact input#q_email").val(''); 
				$(".quickContact input#q_email").focus();  
				return false;  
			}  
			
			// validate comment			
			var comments = $(".quickContact textarea#q_comments").val(); 
			if (comments == "" || comments == "Comments..." || comments.length < 2) { 
				$(".quickContact textarea#q_comments").val(''); 
				$(".quickContact textarea#q_comments").focus();  
				return false;  
			}  
								
			var dataString = 'name='+ $(".quickContact input#q_name").val() + '&email=' + $(".quickContact input#q_email").val() + '&comments=' + $(".quickContact textarea#q_comments").val();									
			$('.quickContact #q_reply_message').addClass('email_loading');
			
			// Send form data to mailer.php 
			$.ajax({
				type: "POST",
				url: "php/mailer_coffee_together.php",
				data: dataString,
				success: function() {
					$('.quickContact #q_reply_message').removeClass('email_loading');
					$('.quickContact #q_reply_message').addClass('list3');
					$('.quickContact #q_reply_message').html("Mail sent sucessfully")
					.hide()
					.fadeIn(1500);
						}
					});
			return false;				
		});
		
		
		
		
		projPage = $(".ajaxPopupPage").length > 0? true : false;
		
		if(projPage){
		
			// Flex slideshow initialize
			$("body").find('.flexSlideshow').each(function(){
					try{
					
						var aniTyp = $(this).hasClass('slideAnimation') ? "slide" : "fade";
						var tim_ = $(this).attr('data-slidetime') ?  Math.abs($(this).attr('data-slidetime')) : 5000;
						
													
						if(aniTyp === "slide"){
							$(this).find("li").each(function(i){
								$(this).find("img").show();
							});
						}

						$(this).addClass("flexslider");		
						var ffx = $(this);
						ffx.removeClass('flexSlideshow');

						var flexs = $(this);
						
						flexs.flexslider({
						slideshow: true,
						animation: aniTyp,
						slideshowSpeed: tim_,
						start: function(slider){
							flexs.data("slid",slider);
							flexs.find(".slider_loading").remove();
							slider.pause();
							}
						});	
							
					} catch (e) { }				
				});	
		}
		
		/* Setting tool create */
		var prevz = '<div class="setting_tools hideTool">';
		prevz += '<a class="iButton"><i class="icon icon-basic-gear" ></i></a>'; 	
		prevz += '<div class="setting_holder">';
		prevz += '<p class="noPadding">MOVE PANEL : &nbsp; <a class="button mUp"><i class="icon icon-arrows-move-top" ></i></a> <a  class="button mDown"><i class="icon icon-arrows-move-bottom" ></i></a></p>'; 
		prevz += '<hr class="separator_bar">';
		prevz += '<p class="first">Home Menu</p>';
		prevz += '<a class="mType1 button">Flat</a>';
		prevz += '<a class="mType2 button">Glass</a>';
		/*prevz += '<p>Page Border</p>';
		prevz += '<a class="borderType1 button">No</a>';
		prevz += '<a class="borderType2 button">Yes</a>';	
		prevz += '<p>COLOR</p>';
		prevz += '<a class="colWhite button"></a>';
		prevz += '<a class="colNight button"></a>';
		prevz += '<a class="colBlack button"></a>';*/
		prevz += '<p>Highlight color</p>';
		prevz += '<a class="temHigLight1 button"></a>';	
		prevz += '<a class="temHigLight2 button"></a>';	
		prevz += '<a class="temHigLight3 button"></a>';
		prevz += '<p></p>';
		prevz += '</div></div>';
		$("body").prepend( prevz );
		
	
		var prevTst = '<a class="button tst"></a>'; 	
		prevTst += '<a class="button tst2"></a>';
	//	$("body").prepend( prevTst );	
	
		
		var eventHoverMc = ('ontouchstart' in document.documentElement) ? 'touchend' : 'mouseover';
		var eventHoutMc = ('ontouchstart' in document.documentElement) ? 'mouseleave' : 'mouseleave';
		var eventClickMc = ('ontouchstart' in document.documentElement) ? 'touchend' : 'mousedown';
		
		cssAnimate = Modernizr.webgl ? true : false;
		animateSyntax = cssAnimate ? "transition" : "animate";
		
		/* Find touch device */		
		if (window.navigator.msMaxTouchPoints) {
			isTouch = Boolean(window.navigator.msMaxTouchPoints>1);			
		} else if (window.navigator.maxTouchPoints && window.navigator.pointerEnabled) {
			isTouch = Boolean(window.navigator.maxTouchPoints);			
		} else {
			isTouch = Modernizr.touch;
		}
		
	//	isTouch = true;

		retinaDevice = window.devicePixelRatio !== undefined &&  window.devicePixelRatio > 1 ? true : false;
		
		if(retinaDevice){
			$("body").addClass("retinaDevice");
		}
		
		if(!isTouch){
			$("body").addClass("notTouchDevice");
		}else{
			$("body").addClass("touchDevice");
		}
	//	isTouch = true;
		pageHeaderHeight = $("body").hasClass("horizontal_layout") || $(".header").hasClass("menuType1") ? 90 : 55;
		
		
		
		
		// Find ipad device
		agent = (window.navigator.userAgent).toLowerCase();
		ipadDevice = agent.indexOf("ipad") > -1;
		iPhoneDevice = agent.indexOf("iphone") > -1;
		iVersion = agent.slice(agent.indexOf("version/")+8,agent.indexOf("version/")+11);
		
		fancy_bgCol = $('body').hasClass("white_ver") ? "#fff" : "#111";
		fancy_bgCol_alpha = .98;
		
		var iimg = !retinaDevice ? "images/supersized/pause.png" : "images/supersized/pause@2x.png";
		$("#pauseplay").attr("src",iimg);
		
		$(".addFxEmbossBtn li a").addClass("fxEmbossBtn");
		$(".addFxEmbossBtn li a").append('<span class="btn_hover"></span> ');

		
		
		if( ! ($.browser.msie && ($.browser.version <= 11)) && !isTouch ) {
			$("body").addClass("addCssTransition");
		}
		
		if( (($.browser.version < 10))) {
			$("body").addClass("itsBadIE");
		}
		
		if(isTouch){	
			$(".hideInTouchDevice").remove();
			$(".removeInTouchDevice").remove();				
		}
		
		
		
/* Fit Text plugin Initialization */	
		try { $(".fittext1").fitText(1.5, { minFontSize: '12px', maxFontSize: '85px' }); } catch (e) { }
		try { $(".fittext2").fitText(1.2, { minFontSize: '12px', maxFontSize: '60px' }); } catch (e) { }
		try { $(".fittext3").fitText(1.1, { minFontSize: '12px', maxFontSize: '40px' }); } catch (e) { }
		
		
	// FitVids Initialization
		try {  $(".container").fitVids(); } catch (e) { }
		try {  $(".container-fluid").fitVids(); } catch (e) { }	

// Home page Diamond shape fix
	
		if(!Modernizr.testAllProps('transform')){
			$(".diamond_container").addClass('fixTransform');
		}
	
	
// Smart Menu
		$(".smartMenu_btn").on(eventClickMc, function(event) { 
			if($("body").hasClass("menuCloseIt")){
				$("body").removeClass("menuCloseIt");
				$("body").addClass("menuOpenIt");	
				$("body").removeClass("autoHideMenuDisable");	
				$("body").addClass("autoHideMenuEnable");				
			}else{
				$("body").removeClass("menuOpenIt");
				$("body").addClass("menuCloseIt");
				$("body").removeClass("autoHideMenuEnable");
				$("body").addClass("autoHideMenuDisable");						
			}
		});
		
		$(".autoHideMenu").on(eventClickMc, function(event) {
			$("body").removeClass("menuOpenIt");
			$("body").addClass("menuCloseIt");
			$("body").removeClass("autoHideMenuEnable");
			$("body").addClass("autoHideMenuDisable");
		});
		
	
// Mobile Menu
	
		$(".mobile_menu_btn").on("click", function(){
			if($(".headerFixed_content").css("display") === "block"){
				$(".headerFixed_content").data("open", false);				
				$(".headerFixed").removeClass("menuOpen");
			}else{
				$(".headerFixed_content").data("open", true);				
				$(".headerFixed").addClass("menuOpen");
				
			}
			setTimeout( function(){ if(!isTouch){ $("html").getNiceScroll().resize(); }	 }, 500);
		});

	

	$(".post_blog").each(function(){
			var p_mc = $(this);
			var len = $(this).children().length;
			p_mc.data("cm", 0);

			
			for (var ik=0; ik < len; ik++){
				var nm = $(this).children().eq(ik);				
				nm.data("nn", ik);				
				$(this).children().eq(ik).on("mouseover", function(event) {
					var ni = $(this);					
					if(p_mc.data("cm") !== ni.data("nn")){
						
						if(p_mc.data("cm") > ni.data("nn") ){
							p_mc.addClass("cursorMoveUp");
						}else{
							p_mc.removeClass("cursorMoveUp");
						}
					}

					p_mc.data("cm", ni.data("nn"));
								
				});				
			}
			
		});
	
// magnificPopup plugin Initialization 
		try{
			//Initialize Image
			$('.magnificPopup').each(function(){
				var mc = $(this);
				var tit = mc.attr("data-title") !== undefined ? "data-title" : "title";
				var typ = mc.attr("data-type") !== undefined ? mc.attr("data-type") : "image";
				mc.magnificPopup({
				  image: { titleSrc : tit },
				  type: typ,
				  removalDelay: 500, //delay removal by X to allow out-animation
				  callbacks: {
					change: function() {
						this.content.addClass("animated fadeInLeft");
					  },
				  },
				  closeOnContentClick: false,
				  closeBtnInside : true,
				  midClick: false // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
				 });
			 });	
		 }	catch (e) { }	  
		 
		 try{
			 //Initialize Gallery
			 $('.magnificPopup_gallery').each(function() { // the containers for all your galleries
				$(this).magnificPopup({
					delegate: 'a', // the selector for gallery item
					type: 'image',
					gallery: {
					  enabled:true
					},
					callbacks: {
					change: function() {
						this.content.addClass("animated fadeInLeft");
					  },
					},
					closeOnContentClick: false,
					midClick: true, // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
				});
			}); 	
		}	catch (e) { }	 
		 
		 try{
			 // Initialize portfolio item gallery
			 $('.magnificPopup_item_gallery').each(function(){
				 var mc = $(this);
				var  p_items = [];
				 mc.find(".i_gallery").children().each(function(){
					var mc2 = $(this);
					var tit = mc2.attr("data-title") !== undefined ? mc2.attr("data-title") : mc2.attr("title");
					p_items.push({ src : mc2.attr("data-href") , title : tit, type : mc2.attr("data-type") });
				});			
				mc.magnificPopup({	
					items:  p_items, // the selector for gallery item
					type: 'image', // this is default type
					removalDelay: 500, //delay removal by X to allow out-animation
					gallery: {
					  enabled:true
					},
					callbacks: {
					change: function() {
						this.content.addClass("animated fadeInLeft");
					  },
					},
					closeOnContentClick: false,
					midClick: true // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
				});
			});
		}	catch (e) { }
		
		try{
			// Initialize inline content
			$('.magnificPopup_inline').magnificPopup({
			  type:'inline',
			  callbacks: {
			  change: function() {
				  this.content.addClass("animated fadeInLeft");
				},
			  },
			  closeOnContentClick: false,
			  midClick: true // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
			});
		}	catch (e) { }
	
	
		try{
			// Initialize popup detail text	
			$('.detail_text').each(function(){	
				var cont = $(this).find(".popup_text");
				$(this).find(".link_btn").magnificPopup({
				  items: {
					  src: cont,
					  type: 'inline'
				  },
				  removalDelay: 500, //delay removal by X to allow out-animation	
				  closeOnContentClick: false,			  
				  midClick: true // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
				});
			});
		}	catch (e) { }
		
		
		$('.ajaxPopup_link').magnificPopup({
			type: 'ajax',
			settings: null,
			alignTop: false,
			cursor: 'mfp-ajax-cur',
			closeOnContentClick: false,
			closeBtnInside : true
		});
		
		
		try{
			 //Initialize Gallery
			 $('.ajaxPopup_gallery').each(function() { // the containers for all your galleries
				$(this).magnificPopup({
					delegate: '.selPopup a.ajaxPopup_galItem', // the selector for gallery item
					type: 'ajax',
					settings: null,
					alignTop: true,
					cursor: 'mfp-ajax-cur',
					gallery: {
					  enabled:true
					},
					closeOnContentClick: false,
					midClick: true, // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
				});
			}); 	
		}	catch (e) { }
		
		
// Initialize Background video show Hide button code
		
		$(".bgVideoBtn").each(function(){
			var on_ = $(this).find(".videoUnMute");
			var off_ = $(this).find(".videoMute");
			
			on_.on(eventClickMc, function(event) {
				off_.show();
				on_.hide();
			});
			
			off_.on(eventClickMc, function(event) {
				off_.hide();
				on_.show();
			});
			
		});

		
		
// Load Big Video for desktop 
		if(!projPage){
			if(Modernizr.video){
						
				$(function() {
					BigVid = new $.BigVideo();
					BigVid.init();					
				});				

				$(".vidPlyPauBtn").data("view", true);
				
				$("body").find('.big_video').each(function(){
					var vmc = $(this);
					var vpath = "";
					var vVolume = "";
					if(vmc.attr("data-background-video") !== undefined){
						vpath = vmc.attr("data-background-video");
						vVolume = isNaN(vmc.attr("data-video-volume")) ? defaultVolume : Number(vmc.attr("data-video-volume"));
					};
					
					vmc.find(".vidPlyPauBtn").each(function() {
						$(this).data("vpath", vpath);
						$(this).data("vVolume", vVolume);
						$(this).data("vHolder", vmc);
					});
					
					vmc.find(".vidPlyPauBtn").on('click', function() {
						if(bgVideopath !== $(this).data("vpath")) {								
							$("#big-video-wrap").css({"display":"block"});				
							$("#big-video-vid").css({"display":"block"});
							$(this).data("vHolder").append($("#big-video-wrap"));	
							bgVideopath = $(this).data("vpath");	
							if(BigVid !== undefined){
								var vpp = bgVideopath.split(",");
								if(vpp < 2){
									BigVid.show(vpp[0] );
								}else{
									BigVid.show(vpp[0], {altSource:vpp[1]}  );
								}
								BigVid.getPlayer().volume($(this).data("vVolume")); 
							}	
							$("#big-video-wrap").css({"display":"block"});
							$("#big-video-vid").css({"display":"block"});
							$(this).find("i").addClass("highlight");	
												
						}else{											
							if($("#big-video-wrap").css("display") !== "none"){
								BigVid.getPlayer().pause();
								$(this).find("i").removeClass("highlight");
								$("#big-video-vid").css({"display":"none"});
								$("#big-video-wrap").css({"display":"none"});
							}else{														
								BigVid.getPlayer().play();
								$(this).find("i").addClass("highlight");
								$("#big-video-vid").css({"display":"block"});
								$("#big-video-wrap").css({"display":"block"});
							}
						}
						
						
					});
				});
				$("#big-video-wrap").css({"display":"none"});
			}
			
		}
		
		/* Twitter initilize */				
							
		$(function () {
			// start jqtweet!
			try{
				JQTWEET.loadTweets( { numTweets: 5 } );
			}catch(e){}
		});	
		
			
/* Flicker feed */

		try {  
		   $('.flickerFeed').each(function(){
			   var numItem = $(this).attr("data-numPost") ? Number($(this).attr("data-numPost")) : 6;
				$(this).jflickrfeed({
				limit: numItem,
				qstrings: {
					id: '52617155@N08'
				},
				itemTemplate:
				'<li>' +
					'<a class="flickerPop" href="{{image}}" title="{{title}}">' +
						'<img src="{{image_s}}" alt="{{title}}" />' +
					'</a>' +
				'</li>'
			  }, function(data) {			  
				 /* $('.flickerPop').magnificPopup({
						mainClass: 'mfp-with-zoom',
						removalDelay: 300,
						type: 'image' // this is default type
					});	*/		
			  });
		  });
		  
		  
		   $('.flickerFeed').each(function(){
				$(this).magnificPopup({
				  delegate: 'a', // child items selector, by clicking on it popup will open
				  type: 'image',
				  gallery:{
					enabled:true
				  },
				  removalDelay: 500, //delay removal by X to allow out-animation
				  callbacks: {
					change: function() {
						this.content.addClass("animated fadeInLeft");
					  },
				  },
				  closeOnContentClick: true,
				  midClick: true // allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source.
				});
		  	});
			
		} catch (e) { }		  
		  

// Hexagon mask fix
  		if(!Modernizr.cssmask){
			$(".hexagon").addClass('circular');
		}
	
		try {
		
			/* Contact page close button*/	
			$(".closeBtn").on('click', function() {
				var sel =	$($(this).attr("data-content"));
				if( parseInt(sel.css("top"), 10) < sel.height()-70){
					sel[animateSyntax]({"top":sel.height()-50},500, "easeInOutQuart");
					$(this).children(":first-child").children(":first-child").css({"right" : "0px"});
				}else{
					sel[animateSyntax]({"top":"0px"},500, "easeInOutQuart");
					$(this).children(":first-child").children(":first-child").css({"right" : "-40px"});
				}
			});
			
			
			/* Add background if it placed below the parallax */
			$("body").find(".inverseStyle.parallax").each(function(){
				$(this).prepend('<div class="inverseStyle" style="position:absolute; width:100%; height:100%; top:0px; left:0px">  </div>')
			});
			
			
			$("body").find(".contentWrapper.lightStyle.parallax").each(function(){
				$(this).prepend('<div class="lightStyle" style="position:absolute; width:100%; height:100%; top:0px; left:0px">  </div>')
			});
			
		} catch (e) { }

		

// Initilize Tab
		
		$('body').find('ul.tabs > li > a').each( function(){
			 $($(this).attr('href')).data("vidd",  $($(this).attr('href')).find('.tabVideo .addVideo') );
		});
		
		$('body').on('click', 'ul.tabs > li > a', function(e) {
			
			//Get Location of tab's content
			var contentLocation = $(this).attr('href');
			//Let go if not a hashed one
			if(contentLocation.charAt(0)=="#") {
			
				e.preventDefault();
			
				//Make Tab Active
				$(this).parent().siblings().children('a').removeClass('active');
				$(this).addClass('active');
			
				//Show Tab Content & add active class
				$(contentLocation).show().addClass('active').siblings().hide().removeClass('active');
			//	$(contentLocation).css({"opacity":"0"})[animateSyntax]({"opacity":1},900);
				
				$('body').find('ul.tabs > li > a').each( function(){
					$($(this).attr('href')).find('.tabVideo .addVideo').remove();
				});

				$(contentLocation).find('.tabVideo').append($(contentLocation).data("vidd"))
				
				$("body").mainFm('scroll_update');
					
				$(contentLocation).find('.graph_container').each(function() {
					$("body").mainFm('graph_display',$(this));
				});
			}
		});



		
// Initilize tipsy 
		try{
			$('.hastip').tipsy({gravity: 's'});		
			$('.dotted-nav li a').tipsy({gravity: 'n', opacity:1 });
			$('.dotted-nav li a, .nav.onlyIcon').on('click', function() {
				$(".tipsy").hide();
				});
		}	catch (e) { }

	
// Initilize Graph
		
		$("body").find('.contentWrapper').each(function(){
			$(this).find('.graph_container').each(function(){
				$(this).find('li').each(function() {
					var selK = $(this).find(".display");
					$(this).each(function() {
						var vall = parseInt($(this).attr('data-level'), 10) >= 100 ? "0%" : (100 - parseInt($(this).attr('data-level'), 10))+"%";
						$(this).children(':first-child').css("width",vall);						
						selK.text( parseInt($(this).attr('data-level'), 10) );
					});
				});
			});

		});
		
			
// Accordion
		
		jQuery(function($){
				 
			$('.accordion').each( function(){
				
				var allDt = $(this);
				var allPanels = allDt.find(' > dd').hide();
				allDt.find(' dt a').removeClass("active");
				 
				if($(this).attr("data-openFirstElement") === "true"){
				  $(this).children(":first-child").find("a").data('show',true);
				  $(this).children(":first-child").find("a").addClass("active");
				  var $target =  $(this).children(":first-child").next();
				  $target.addClass('active').slideDown();
				}
				
				
				$(this).find(' > dt > a').on('click', function() {
					var $this = $(this);
					var $target =  $this.parent().next();
					
					$("body").mainFm('intVideoObject', $this);				
					$("body").find('.tabVideo').each(function(){
						$(this).find('.vid').remove();
						$(this).find('img').show();
						$(this).find('.video_hover').show().css({"z-index":"5"});
					});
					
					$target.find("a.lazyload").each(function(){
						$("body").mainFm('lazyLoadInt', $(this));
					});
					
					$target.find("a.lazyload_single").each(function(){
						$("body").mainFm('lazyLoadInt', $(this));
					});
					
					$target.find("a.lazyload_fluid").each(function(){
						$("body").mainFm('lazyLoadInt', $(this));
					});
										
					
					$("body").mainFm('intVideoObject', $this);
									
					$("body").find('.tabVideo').each(function(){
						$(this).find('.vid').remove();
						$(this).find('img').show();
						$(this).find('.video_hover').show().css({"z-index":"5"});
					});
					
					
					if($(this).parent().parent().attr("data-autoHide") !== "false"){
						if($this.hasClass("active")){
							allDt.find(' dt a').removeClass("active");
							allPanels.removeClass('active').slideUp();
						}else{
						allDt.find(' dt a').removeClass("active");
						$this.addClass("active");
						$target =  $this.parent().next();
						if(!$target.hasClass('active')){
							allPanels.removeClass('active').slideUp();
							$target.addClass('active').slideDown();
						}
						
						}
					}else{	
						
						if($this.data('show')){
							$this.data('show',false);
							$this.removeClass("active");
							$target.removeClass('active').slideUp();
						}else{
							$this.data('show',true);
							$this.addClass("active");
							$target.addClass('active').slideDown();							
						}
						
					}
					
					setTimeout(function(){ $("body").mainFm('scroll_update'); },500);
					
					return false;
				});
			});
		}); 
	
		jQuery(function($){
		  var allPanels = $('.accordion_autoHide > dd').hide();
		  $('.accordion_autoHide > dt > a').prepend('<span class="closeOpen" ></span>');
		  $('.accordion_autoHide > dt > a').on('click', function() {
			$('.accordion_autoHide dt a').removeClass("active");
			var $this = $(this);
			$this.addClass("active");
			$target =  $this.parent().next();
			if(!$target.hasClass('active')){
			  allPanels.removeClass('active').slideUp();
			  $target.addClass('active').slideDown();
			}

			setTimeout(function(){ $("body").mainFm('scroll_update'); },500);
			return false;
		  });
		});
		
		
		
		if(!projPage){
			
			$(function($) {

                $(".knob").knob({
                    change : function (value) {
                        //console.log("change : " + value);
                    },
                    release : function (value) {
                        //console.log(this.$.attr('value'));
                        console.log("release : " + value);
                    },
                    cancel : function () {
                        console.log("cancel : ", this);
                    },
                    draw : function () {

                        // "tron" case
                        if(this.$.data('skin') == 'tron') {

                            var a = this.angle(this.cv)  // Angle
                                , sa = this.startAngle          // Previous start angle
                                , sat = this.startAngle         // Start angle
                                , ea                            // Previous end angle
                                , eat = sat + a                 // End angle
                                , r = 1;

                            this.g.lineWidth = this.lineWidth;

                            this.o.cursor
                                && (sat = eat - 0.3)
                                && (eat = eat + 0.3);

                            if (this.o.displayPrevious) {
                                ea = this.startAngle + this.angle(this.v);
                                this.o.cursor
                                    && (sa = ea - 0.3)
                                    && (ea = ea + 0.3);
                                this.g.beginPath();
                                this.g.strokeStyle = this.pColor;
                                this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sa, ea, false);
                                this.g.stroke();
                            }

                            this.g.beginPath();
                            this.g.strokeStyle = r ? this.o.fgColor : this.fgColor ;
                            this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sat, eat, false);
                            this.g.stroke();

                            this.g.lineWidth = 2;
                            this.g.beginPath();
                            this.g.strokeStyle = this.o.fgColor;
                            this.g.arc( this.xy, this.xy, this.radius - this.lineWidth + 1 + this.lineWidth * 2 / 3, 0, 2 * Math.PI, false);
                            this.g.stroke();

                            return false;
                        }
                    }
                });

                // Example of infinite knob, iPod click wheel
                var v, up=0,down=0,i=0
                    ,$idir = $("div.idir")
                    ,$ival = $("div.ival")
                    ,incr = function() { i++; $idir.show().html("+").fadeOut(); $ival.html(i); }
                    ,decr = function() { i--; $idir.show().html("-").fadeOut(); $ival.html(i); };
                $("input.infinite").knob(
                                    {
                                    min : 0
                                    , max : 20
                                    , stopper : false
                                    , change : function () {
                                                    if(v > this.cv){
                                                        if(up){
                                                            decr();
                                                            up=0;
                                                        }else{up=1;down=0;}
                                                    } else {
                                                        if(v < this.cv){
                                                            if(down){
                                                                incr();
                                                                down=0;
                                                            }else{down=1;up=0;}
                                                        }
                                                    }
                                                    v = this.cv;
                                                }
                                    });
            });	
			
		}
	
	});






		

/* Initilize vimeo player */



function vimeo_video(mc){
	(function(){
	  // Listen for the ready event for any vimeo video players on the page
	  var  player = document.querySelector(mc);
	   $f(player).addEvent('ready', ready);
	  

	  function addEvent(element, eventName, callback) {
		  if (element.addEventListener) {
			  element.addEventListener(eventName, callback, false);
		  }
		  else {
			  element.attachEvent('on' + eventName, callback);
		  }
	  }

	  function ready(player_id) {
		  // Keep a reference to Froogaloop for this player
		  var container = document.getElementById(player_id).parentNode.parentNode,

			  froogaloop = $f(player_id);
		  
		  //buttons = container.querySelector('div dl.simple'),
			  var volumeBtn = container.querySelector('.volume');
			  
			  if(volumeBtn){
				  froogaloop.api('setVolume', 0);
			   
				  // Call setVolume when volume button clicked
				  addEvent(volumeBtn, 'click', function(e) {
					  // Don't do anything if clicking on anything but the button (such as the input field)
					  if (e.target != this) {
						  return false;
					  }
	
					  // Grab the value in the input field
					  var volumeVal = this.querySelector('input').value;
	
					  // Call the api via froogaloop
					  froogaloop.api('setVolume', volumeVal);
				  }, false);
	
				  // Call setLoop when loop button clicked 
			  }
	  }
  })();
}



/* cycle slideshow plugin  initilize */

function cycle_pluign(mc){
	var aniType = mc.attr("data-transition") ? mc.attr("data-transition") : 'scrollDown';
	var tim = !isNaN(mc.attr("data-starttime")) ? Number(mc.attr("data-starttime")) : 0;
	var tim_end = !isNaN(mc.attr("data-endtime")) ? Number(mc.attr("data-endtime")) : 2000;
	var easingType = mc.attr("data-easing") ? mc.attr("data-easing") : 'easeInOutBack';
	var pauseHover = mc.attr("data-pauseHover") === "no" ? false : true;
	mc.hide();
	var nextBtn = mc.find(".next");
	var prevBtn = mc.find(".prev");
	mc.parent().find(".cycleNextPrev").append(nextBtn);
	mc.parent().find(".cycleNextPrev").append(prevBtn);
	setTimeout(function(){
		mc.show();
		mc.cycle({
			fx: aniType, // choose your transition type, ex: fade, scrollUp, shuffle, etc...
			speed:    1000, 
			easing: easingType,
			containerResize: 1,
			slideResize:      1,
			timeout:  tim_end ,
			pause:   pauseHover,
			next: nextBtn,
            prev: prevBtn
		});
	}, tim)
}	



// Initilize elastislide slider, Used in fullScreen Gallery, Portfolio detail page gallery (see portfolio.html file)
	
	function carousel_gallery_int (mc){	

		mc.find(".carousel_thumbails").css({"visibility":"hidden", "opacity":0});							
		var current = 0,					
		$carouselEl = mc.find(".carousel_thumbails"),
		$preview = $( mc.attr("data-link") ),
		$carouselItems = $carouselEl.children(),
		isFullScreen = mc.hasClass("fullScreen"),
		isSmoothResize = $preview.hasClass("smooth_resize"),
		smothFirstLod = true,
		nextBtn = $preview.find('.proj_next'),
		prevBtn = $preview.find('.proj_prev'),
		fullNextBtn = $preview.find(".gallery_navigations a.next_button"),
		fullPrevBtn = $preview.find(".gallery_navigations a.previous_button"),
		fullClosBtn = $preview.find(".gallery_navigations a.thumbClose_btn");
		
		var carousel = $carouselEl.elastislide( {
			current : current,
			minItems : 1,
			onClick : function( el, pos, evt ) {
				changeImage( el, pos, isFullScreen);
				evt.preventDefault();
			},
			onReady : function() {
				mc.find(".carousel_thumbails").css({"visibility":"visible"}).animate({"opacity":1}, 200, "easeInOutQuart");				 
				try{
					var thu = $( mc.data("thu"));
					var sc = thu.find('.thumbClose_btn .btn_icon');
					var cc = thu;
					thu.css({"visibility":"visible"});
					if(self.alignPgHor && !isTouch){
						ele.mCustomScrollbar("update");
						ele.mCustomScrollbar("scrollTo","top");	
					}
					thu.addClass("mobileView");
					sc.children(":first-child").text("Thumbnails");					
					
					if(sc.data("firLod") === undefined){
						sc.data("firLod", true);
					}
					
					prevBtn.css({"opacity":.5});

					nextBtn.on('click', function() { goNextSlider(); });					
					prevBtn.on('click', function() { goPrevSlider(); });
					fullNextBtn.on('click', function() { goNextSlider(); });
					fullPrevBtn.on('click', function() { goPrevSlider(); });
						
					fullClosBtn.on('click', function() {					
						if(!mc.data("thu").hasClass("miniView")){
							var ccc = $carouselEl.data("cur");
							if($carouselEl.data("cur") < 3 || $carouselEl.data("cur") > $carouselEl.children().length-5){
								ccc = $carouselEl.data("cur") < 3 ? 3 : $carouselEl.children().length-5;
							}
							carousel._slideTo(ccc);
						}
					});
					
					
				} catch(e){ }
					
					if($preview !== undefined && (isTouch || !isMouseDrag)){
						try{		  
						$(function() {	
							$preview.swipe( {
								//Generic swipe handler for all directions
								swipe:function(event, direction, distance, duration, fingerCount) {
									if(direction === "left"){
										goNextSlider();
									}
									if(direction === "right"){
										goPrevSlider();
									}
									
								},
								allowPageScroll : "vertical",
								//Default is 75px, set to 0 for demo so any distance triggers swipe
								threshold:swipeThreshold
							});
						});
						
					  }catch(e){}
					}					
					mc.data("thu").data("cHovBtn", "nx");
					setTimeout(function(){ changeImage( $carouselItems.eq( current ), current, isFullScreen ); }, 1000)	
				} 
					                 
			});
		
		var interval;
		
		function goNextSlider(){
			
			if($carouselItems.length-1 > current){							
				  current = current+1;	
			}else{
				 current = 0;
			}
									
			$carouselItems.removeClass( 'current-img' );
			$carouselItems.eq( current ).addClass( 'current-img' );
			if(!$($carouselEl).parent().parent().parent().hasClass("withoutThumb")){
				carousel.setCurrent( current );			
			//	carousel._slideToItem(current);					
			}
			changeImage( $carouselItems.eq( current ), current, false );			
			mc.data("thu").data("cHovBtn", "nx");			  			
		}
		
		function goPrevSlider(){
			if(current > 0){							
				current = current - 1;	
			}else{
				current = $carouselItems.length-1;
			}				
			$carouselItems.removeClass( 'current-img' );
			$carouselItems.eq( current ).addClass( 'current-img' );
			if(!$($carouselEl).parent().parent().parent().hasClass("withoutThumb")){
				carousel.setCurrent( current );			
			//	carousel._slideToItem(current);
			}
			changeImage( $carouselItems.eq( current ), current, false );			
			mc.data("thu").data("cHovBtn", "px");
		}
			
		function changeImage( el, pos, isFullScreen ) {	
					
			if(isSmoothResize && !smothFirstLod){
				$preview.css({"height":$preview.height()});				
			}	
			
			$("body").mainFm('fullScreenGallery', $preview);					

			var nn = 0;		
			
			var inAnimat = $preview.attr("data-animated-in") !== undefined ? $preview.attr("data-animated-in") : aniInEff;
			var outAnimat = $preview.attr("data-animated-out") !== undefined ? $preview.attr("data-animated-out") : aniOutEff;			
					
			$preview.data("startLoaded", false);
			
			function resetImg (mc, in_, out_){
				$preview.data("startLoaded", true);
			};
						 
			$preview.find(".carousel_item").each(function(){				
				if("#"+$(this).attr("id") != el.data( 'preview')){
					clearInterval(interval);
					
					if( $(this).css("display") !== "none"){
						nn++;
					 
						 var kk = -5;
						 var self = $(this);
						 var aniInTyp = aniInEff;
						 var aniOutTyp = aniOutEff;
						 
						 var mc_ = $(this);
						 var jj = 0;
					  
						if(jj == 0){
					  
							mc_.find(".animated").each(function(){
							  $(this).removeClass($(this).attr("data-in"));
							  $(this).removeClass($(this).attr("data-out"));
							});
							
							mc_.find(".animated").each(function(){
							 $(this).addClass($(this).attr("data-out"));
							});
							
							$preview.css({"height":  $preview.outerHeight() });
							
							setTimeout(function(){ mc_.hide(); },500);			
							resetImg(mc_, inAnimat, outAnimat);
						}
					}
				}				  
			});
			
			var displayInterval = 600;
			if(nn === 0){
				displayInterval = 0;
				$preview.data("startLoaded", true);
			}
			
			interval =	setInterval(function(){

				if($preview.data("startLoaded") == undefined){
					clearInterval(interval); 
				}
				
				if($preview.data("startLoaded")){
					clearInterval(interval); 
					
					  var itm = $preview.find(el.data('preview'));	
					  itm.css({"left": $preview.width()});
					  
					  itm.find("a.lazyload").each(function(){	
						var dd = $(this);		
						$("body").mainFm('lazyLoadInt', $(this))
					  });
					  
					  itm.find("a.lazyload_gallery").each(function(){
						  var dd2 = $(this);		
						 $("body").mainFm('lazyLoadInt', $(this))
					  });
					  
					  var pattern = $preview.find(".overlayPattern");
					  if(!isTouch){	
						pattern.show();
						 $(this).find(".addVideo").each(function(){
							$(this).find(".overlayPattern").show();
							pattern.hide();
						});
					  }else{
						   pattern.hide();
					  }
					  
					  var kk = -5;
					  var mc_ = itm;
					  var leng = 0;
					  var aniTyp  = inAnimat;
					  
					 var mct = $preview.find(el.data('preview'));
					 
					 mct.stop().show().css({"left": 0});
					 
					mct.find(".animated").each(function(){
						$(this).removeClass($(this).attr("data-in"));
						$(this).removeClass($(this).attr("data-out"));
					  });
					  
					mct.find(".animated").each(function(){
					 	$(this).addClass($(this).attr("data-in"));
					});
					
					if(isSmoothResize){
						  $preview.delay(600).animate({"height": $preview.outerHeight()}, 500 , "easeInOutQuart", function(){
							  $preview.css({"height": "auto"});
						  });
					 }
					
					$("body").mainFm('scroll_update');	
					  
				}
			}, displayInterval);				  
  
				  
			$carouselItems.removeClass( 'current-img' );
			el.addClass( 'current-img' );
			if(!$($carouselEl).parent().parent().parent().hasClass("withoutThumb")){
				carousel.setCurrent( pos );	
			}

			$carouselEl.data("cur", pos);		
			

			prevBtn.css({"opacity":1});
			nextBtn.css({"opacity":1});
			
			if(pos > $carouselItems.length-2){
				nextBtn.css({"opacity":.5});				
			}
			
			if(pos < 1){
				prevBtn.css({"opacity":.5});
			}	
			
			current = pos;
					
			var tim = $carouselEl.data("fLod") === undefined ?  3500 : 1200;
			$carouselEl.data("fLod" , true);
		}
		
		$carouselEl.data("fn",changeImage);
		$carouselEl.data("pl",carousel);
		
		
}





// Google map Code



var gMapStore;
var mapPos;
var latlng;
var wWid_ = window.innerWidth;
var wHig_ = window.innerHeight;
var pointerHorPos = wWid_ > 991 ? wWid_/4 - 40 :  0;
var pointerVerPos = 0;

function map_initialize() {
  "use strict";  
  
	var map;
	var openedInfoWindow = null;
	
	pointerHorPos = wWid_ > 991 && !$("#map_canvas").hasClass("pointerCenter") ? wWid_/4 - 40 :  0;
	
	mapPos = new google.maps.LatLng(34.05223, -118.24368);
	latlng = mapPos;

	var MY_MAPTYPE_ID = 'custom_style';
  
  	  var featureOpts = [
    {
      stylers: [
        { hue: "#222222" },
        { visibility: 'simplified' },
        { saturation: -100 },
        { weight: .5 }
      ]
    },
    {
      elementType: 'labels',
      stylers: [
        { visibility: 'on' }
      ]
    },
    {
      featureType: 'water',
      stylers: [
        { color: '#222222' }
      ]
    }
  ];
  
  
  
 var styledMapOptions = {
	  name: 'Custom Style'
  };

  var customMapType = new google.maps.StyledMapType(featureOpts, styledMapOptions);
  
  var companyPos = mapPos;
  var settings = {
	  zoom: 15,
	  scrollwheel: false,
	  center: latlng,
	  mapTypeControl: true,
	  
	  navigationControl: true,
	  navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
	  mapTypeId: MY_MAPTYPE_ID};
		
	var map = new google.maps.Map(document.getElementById("map_canvas"), settings);	

  	map.mapTypes.set(MY_MAPTYPE_ID, customMapType);

	google.maps.Map.prototype.panToWithOffset = function(latlng, offsetX, offsetY) {
		var map = this;
		var ov = new google.maps.OverlayView();
		ov.onAdd = function() {
			var proj = this.getProjection();
			var aPoint = proj.fromLatLngToContainerPixel(latlng);
			aPoint.x = aPoint.x+offsetX;
			aPoint.y = aPoint.y+offsetY;
			map.panTo(proj.fromContainerPixelToLatLng(aPoint));
		}; 
		ov.draw = function() {}; 
		ov.setMap(this); 
	};
	
	map.panToWithOffset(latlng, pointerHorPos, pointerVerPos);
	 
	var contentString = '<div id="content">'+
		'<div id="siteNotice">'+
		'</div>'+
		'<h4 id="firstHeading" class="mapStyle firstHeading">FMediastudios</h4>'+
		'<div id="mapStyle">'+
		'<p class="mapStyle">Leading web design studio</p>'+
		'</div>'+
		'</div>';
	var infowindow = new google.maps.InfoWindow({
		content: contentString
	});
	
	var companyImage = new google.maps.MarkerImage('images/map/logo.png',
		new google.maps.Size(100,100),
		new google.maps.Point(0,0),
		new google.maps.Point(50,100)
	);

	var companyShadow = new google.maps.MarkerImage('images/map/logo_shadow.png',
		new google.maps.Size(130,50),
		new google.maps.Point(0,0),
		new google.maps.Point(65, 100));

	/*var companyPos = new google.maps.LatLng(57.0442, 9.9116);*/

	var companyMarker = new google.maps.Marker({
		position: companyPos,
		map: map,
		icon: companyImage,
		shadow: companyShadow,
		title:"Høgenhaug",
		zIndex: 3});
	
	gMapStore = map;
	
	google.maps.event.addListener(companyMarker, 'click', function() {
		if (openedInfoWindow != null) openedInfoWindow.close();  // <-- changed this
		infowindow.open(map,companyMarker);	
		openedInfoWindow = infowindow;
      	google.maps.event.addListener(infowindow, 'closeclick', function() {
		   map.panToWithOffset(latlng, pointerHorPos, pointerVerPos);
		});	
	});
	
	var mapInterval;
	$(window).resize(function() {	
		clearInterval(mapInterval);
		mapInterval = setInterval(function(){
			clearInterval(mapInterval); 
			wHig_ = window.innerHeight;
			mapResizer();
		},700);
	});
	
}

function mapResizer(){
	wWid_ = window.innerWidth;
	wHig_ = window.innerHeight;
	pointerHorPos = wWid_ > 991 && !$("#map_canvas").hasClass("pointerCenter") ? wWid_/4 - 40 :  0;
	pointerVerPos = 0;
	try{
	gMapStore.panToWithOffset(latlng, pointerHorPos, pointerVerPos);
	} catch (e) { }
}

